#!/usr/sbin/nft -f

# make sure table exists so delete never fails
table inet filter
# delete only the inet filter table
delete table inet filter

table inet filter {
	chain input {
		type filter hook input priority 0; policy drop;

		iif lo accept comment "Accept any localhost traffic"
		ct state invalid drop comment "Drop invalid connections"
		ct state established,related accept comment "Accept traffic originated from us"
		
		meta l4proto ipv6-icmp accept comment "Accept ICMPv6"
		meta l4proto icmp accept comment "Accept ICMP"
		ip protocol igmp accept comment "Accept IGMP"

		tcp dport 22 counter accept comment "Accept SSH"
		tcp dport { 80, 443 } counter accept comment "Accept HTTP(S)"
	}

	chain forward {
		type filter hook forward priority 0; policy accept;
	}

	chain output {
		type filter hook output priority 0;
	}
}
